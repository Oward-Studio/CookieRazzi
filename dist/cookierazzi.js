"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var cookieRazzi=/*#__PURE__*/function(){function a(){_classCallCheck(this,a),this.popup,this.popupDisplayed=!1,this.cname="cmp",this.seed=1,this.text={title:"Nous respectons votre vie priv\xE9e",intro:"Nous utilisons des cookies pour am\xE9liorer et personnaliser votre exp\xE9rience.",desc:"Vous pouvez \xE0 tout moment revenir sur vos choix en utilisant le lien \xAB param\xE9trer les cookies sur ce site \xBB disponible dans notre politique de gestion des cookies.",accept:"Je valide",reject_all:"Non merci",accept_all:"J'accepte tout"},this.consents={necessary:{forced:!0,value:!0,icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAJUWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDYgNzkuMTY0NzUzLCAyMDIxLzAyLzE1LTExOjUyOjEzICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjMgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyMS0wNC0wOFQxNjowNjoyMSswMjowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNC0wOFQxNjoxNzowNSswMjowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjEtMDQtMDhUMTY6MTc6MDUrMDI6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjkxZDgyOTMyLTYwZTYtNzA0Yi1hYzMyLTI5ODYyODhhYWRmMSIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmExMjUxYWU4LTYwYWItYzM0Mi04MDA5LWU0Y2QxMTJlOGMyNCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjQ0ZjE2ODk2LTI3MzYtZDQ0NS1hNGQ0LWY3MTQxMmJmZWQxMyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NDRmMTY4OTYtMjczNi1kNDQ1LWE0ZDQtZjcxNDEyYmZlZDEzIiBzdEV2dDp3aGVuPSIyMDIxLTA0LTA4VDE2OjA2OjIxKzAyOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjg4YTg5MTQ0LTVjY2EtYjU0NS1hMDQ2LTQyNjZmY2FmOWNiOCIgc3RFdnQ6d2hlbj0iMjAyMS0wNC0wOFQxNjoxNyswMjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjMgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo4YzYwZjNiMS1kOTQwLTM2NGYtYmMxMi1lZTUxYzVjNjgwZTUiIHN0RXZ0OndoZW49IjIwMjEtMDQtMDhUMTY6MTc6MDUrMDI6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4zIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OTFkODI5MzItNjBlNi03MDRiLWFjMzItMjk4NjI4OGFhZGYxIiBzdEV2dDp3aGVuPSIyMDIxLTA0LTA4VDE2OjE3OjA1KzAyOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjIuMyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjhjNjBmM2IxLWQ5NDAtMzY0Zi1iYzEyLWVlNTFjNWM2ODBlNSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0NGYxNjg5Ni0yNzM2LWQ0NDUtYTRkNC1mNzE0MTJiZmVkMTMiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo0NGYxNjg5Ni0yNzM2LWQ0NDUtYTRkNC1mNzE0MTJiZmVkMTMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6/fS8rAAAAvklEQVQ4y62TsQ3EIAxFKa5FV1y6SFezDAtkjKRKRoGWIWhPaVKRleJIH8myTHEixZPAfIz9AeO9Nw0icYDY0vGJJTbCYf5ja3XsoLEywR3YiZk4iUwkliAhdkKz1yRVsBILxh9iVModsWagXXkCh+yD2PQCPDZA66QHmZ38RtkFJMRqJZl7EGGS7Hli80lZv/cEg2uSZRfFg6K0czySIPS2oJloFRNty8RHrlE+pO+/D6n7KXd/Jo3AvnNo6S4AYiReJHwqjgAAAABJRU5ErkJggg==",title:"Strictement n\xE9cessaires",text:"Il s'agit de cookies n\xE9cessaires au fonctionnement de la plateforme et de notre entreprise. Ils vous permettent de vous connecter et de rester connect\xE9 au site et nous permettent \xE9galement de mesurer anonymement le trafic du site et d'assurer sa s\xE9curit\xE9. Sans cette technologie, nos services ne pourront pas fonctionner convenablement et/ou nous ne serons pas en mesure de vous proposer certaines fonctionnalit\xE9s",callback:!1}}}return _createClass(a,[{key:"addConsent",value:function addConsent(a){Object.assign(this.consents,a)}// getDomain(){
//   if(this.tld){
//     return window.location.hostname.split('.').slice(-2).join('.');
//   }
//   return window.location.hostname;
// }
// getDomainRef(){
//   return this.tld ? this.getDomain().substring(0,3) : window.location.hostname.substring(0,1) + '_' + this.getDomain().substring(0,3);
// }
},{key:"stringToSlug",value:function stringToSlug(a){a=a.replace(/^\s+|\s+$/g,""),a=a.toLowerCase();for(var b="\xE0\xE1\xE4\xE2\xE8\xE9\xEB\xEA\xEC\xED\xEF\xEE\xF2\xF3\xF6\xF4\xF9\xFA\xFC\xFB\xF1\xE7\xB7/_,:;",c=0,d=b.length;c<d;c++)a=a.replace(new RegExp(b.charAt(c),"g"),"aaaaeeeeiiiioooouuuunc------".charAt(c));// collapse dashes
return a=a.replace(/[^a-z0-9 -]/g,"")// remove invalid chars
.replace(/\s+/g,"-")// collapse whitespace and replace by -
.replace(/-+/g,"-"),a}// public methods
},{key:"setSeed",value:function setSeed(a){this.seed=a}},{key:"setText",value:function setText(a){this.text=Object.assign({},this.text,a)}},{key:"debug",value:function(){var a={Consents:this.consents,Cookie:this.getCookie(),Seed:this.seed,TLD:this.tld,Popup:this.popup,Texts:this.text// "DomainRef": this.getDomainRef(),
};console.log(a)}// setTld(value){
//   this.tld = !!value;
// }
},{key:"getCookie",value:function getCookie(){var a={};return document.cookie.split(";").forEach(function(b){var c=b.split("="),d=_slicedToArray(c,2),e=d[0],f=d[1];a[e.trim()]=f}),!!a[this.cname]&&JSON.parse(a[this.cname])}},{key:"setCookie",value:function setCookie(a){var b=new Date;""==a?b.setMonth(b.getMonth()-1):b.setMonth(b.getMonth()+1),document.cookie=this.cname+"="+a+"; path=/; expires="+b.toGMTString()+"; Secure"}},{key:"init",value:function init(a){var b=this,c=this.getCookie();// On lance les callbacks à l'init si le cookie existe
for(var d in this.setPopup(),c.seed&&c.seed==this.seed?this.setUserConsents():this.setCookie(""),this.consents)if("function"==typeof this.consents[d].callback){// Si il n'y a pas de cookie de définit, la valeur par default transmise au callback est false
var f=!1;c&&c.userConsents[d]&&(f=c.userConsents[d]),this.consents[d].callback(f)}// Si la popup n'a jamais été affichée ou qu'on la force
(!c.popupDisplayed||a)&&this.showPopup(),this.setPopupDisplayedTime(c);// Permet ré-afficher la popup simplement
var e=document.querySelectorAll(".show-"+this.cname);e.forEach(function(a){a.addEventListener("click",function(a){a.preventDefault(),b.showPopup()})})}},{key:"setPopupDisplayedTime",value:function setPopupDisplayedTime(a){this.popupDisplayed=a.popupDisplayed?a.popupDisplayed:new Date}},{key:"getData",value:function getData(){var a={seed:this.seed,popupDisplayed:this.popupDisplayed,userConsents:this.getUserConsents()};return JSON.stringify(a)}},{key:"setUserConsents",value:function setUserConsents(){var a=this.getCookie();if(a.userConsents){var c=a.userConsents;for(var b in c)document.getElementById(b)&&(document.getElementById(b).checked=c[b])}}},{key:"getUserConsents",value:function getUserConsents(){var a=document.getElementById("cmp_"+this.seed),b={},c=[];if(!!a&&"object"==_typeof(a)&&"FORM"==a.nodeName)for(var d=a.elements.length,e=0;e<d;e++)c=a.elements[e],"checkbox"==c.type&&c.name&&!c.disabled&&"file"!=c.type&&"reset"!=c.type&&"submit"!=c.type&&"button"!=c.type&&(b[encodeURIComponent(c.name)]=c.checked,!1!=this.consents[c.name].callback&&this.consents[c.name].callback(c.checked));return b}},{key:"setPopup",value:function setPopup(){var a=this;document.getElementById("cmp_"+this.seed);var b=this.popup,c=this.consents,d="";for(var e in d="\n      <div class=\"cmp-box\">\n      <p class=\"cmp-title\">".concat(this.text.title,"</p>"),this.text.intro&&""!=this.text.intro&&(d+="<p>".concat(this.text.intro,"</p>")),this.text.desc&&""!=this.text.desc&&(d+="<p>".concat(this.text.desc,"</p>")),d+="<div class=\"cmp-list\">",c)if(c.hasOwnProperty(e)){var f=c[e];d+="<div class=\"cmp-consent\"><div class=\"cmp-label\">",f.icon&&(d+="<img src=\"".concat(f.icon,"\" width=\"16\" height=\"16\">")),d+="\n          <label>\n            <input type=\"checkbox\" name=\"".concat(this.stringToSlug(e),"\" id=\"").concat(this.stringToSlug(e),"\" ").concat(f.forced?"required disabled":""," ").concat(f.value?"checked":"",">\n            <span>").concat(f.title,"</span>\n          </label>\n          <div class=\"cmp-arrow\"></div>\n        </div>\n        <div class=\"cmp-desc\">\n          <p>").concat(f.text,"</p>\n        </div>\n      </div>")}d+="</div>",d+="</div>",d+="<div class=\"cmp-btns\">\n      <button class=\"button\" id=\"cmp_reject_all\">".concat(this.text.reject_all,"</button>\n      <button class=\"button\" id=\"cmp_choose\">").concat(this.text.accept,"</button>\n      <button class=\"button\" id=\"cmp_accept_all\">").concat(this.text.accept_all,"</button>\n      </div>\n    "),b=document.createElement("form"),b.id="cmp_"+this.seed,b.classList.add("cmp"),b.classList.add("hidden"),b.innerHTML=d,document.body.appendChild(b);var g=document.querySelectorAll(".cmp-arrow");g.forEach(function(a){a.addEventListener("click",function(){a.closest(".cmp-consent").classList.toggle("active")})});var h=document.getElementById("cmp_reject_all");h.addEventListener("click",function(b){b.preventDefault();var c=a.consents;for(var d in c)if(c.hasOwnProperty(d)){c[d];a.setCheckbox(a.stringToSlug(d),!1)}// On reset la date d'affichage de la popup
a.popupDisplayed=new Date,a.setCookie(a.getData()),a.hidePopup()});var i=document.getElementById("cmp_choose");i.addEventListener("click",function(b){b.preventDefault(),a.popupDisplayed=new Date,a.setCookie(a.getData()),a.hidePopup()});var j=document.getElementById("cmp_accept_all");j.addEventListener("click",function(b){b.preventDefault();var c=a.consents;for(var d in c)if(c.hasOwnProperty(d)){c[d];a.setCheckbox(a.stringToSlug(d),!0)}// On reset la date d'affichage de la popup
a.popupDisplayed=new Date,a.setCookie(a.getData()),a.hidePopup()})}},{key:"setCheckbox",value:function setCheckbox(a,b){var c=document.getElementById(a);c.disabled||(c.checked=!!b)}},{key:"showPopup",value:function showPopup(){document.getElementById("cmp_"+this.seed).classList.remove("hidden")}},{key:"hidePopup",value:function hidePopup(){document.getElementById("cmp_"+this.seed).classList.add("hidden")}}]),a}();// export default cookieRazzi;
